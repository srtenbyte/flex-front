{"version":3,"file":"index.modern.js","sources":["../src/index.js"],"sourcesContent":["import React, { Component } from 'react';\n// import styles from './styles.module.css'\nimport { version } from '../package.json';\n\nexport class CSVBoxButton extends Component {\n\n  constructor(props) {\n    super(props)\n    this.holder = React.createRef();\n    this.openModal = this.openModal.bind(this)\n    this.isModalShown = false;\n    this.shouldOpenModalOnReady = false;\n    this.uuid = this.generateUuid();\n    this.state = {\n      isLoading: true\n    };\n    this.iframe = null;\n  }\n\n  componentDidMount() {\n    const { lazy } = this.props;\n    if(!lazy && !this.iframe) {\n      this.initImporter();\n    }else if(lazy) {\n      this.enableInitator();\n    }\n  }\n\n  initImporter() {\n\n    const { loadStarted } = this.props;\n\n    loadStarted?.();\n\n    const { user } = this.props;\n    const { dynamicColumns } = this.props;\n    const { options } = this.props;\n    const { onReady } = this.props;\n    const { onImport } = this.props;\n    const { onSubmit } = this.props;\n    const { onClose } = this.props;\n    const { licenseKey } = this.props;\n    const { dataLocation } = this.props;\n    const { customDomain } = this.props;\n    const { language } = this.props;\n    const { environment } = this.props;\n    const { theme } = this.props;\n\n    let domain = customDomain ? customDomain : \"app.csvbox.io\";\n\n    if(dataLocation) {\n      domain = `${dataLocation}-${domain}`;\n    }\n\n    let iframeUrl = `https://${domain}/embed/${licenseKey}`;\n\n    iframeUrl += `?library-version=${version}`;\n    iframeUrl += \"&framework=react\";\n\n    if(dataLocation) {\n      iframeUrl += \"&preventRedirect\";\n    }\n\n    if(language) {\n      iframeUrl += \"&language=\" + language;\n    }\n\n    if(theme) {\n      iframeUrl += \"&theme=\" + theme;\n    }\n\n    if(environment) {\n      let env = JSON.stringify(environment).replace(/['\"]/g, function(match) {\n        return '\\\\' + match;\n      });\n      iframeUrl += `&env=${env}`;\n    }\n\n    window.addEventListener(\"message\", (event) => {\n\n      if (event.data === \"mainModalHidden\") {\n        if (this.holder && this.holder.current) {\n          this.holder.current.style.display = 'none';\n        };\n        this.isModalShown = false;\n        onClose?.();\n      }\n      if(event.data === \"uploadSuccessful\") {\n        onImport(true);\n      }\n      if(event.data === \"uploadFailed\") {\n        onImport(false);\n      }\n      if(typeof event.data == \"object\") {\n\n        if(event?.data?.data?.unique_token == this.uuid) {\n\n          if(event.data.type && event.data.type == \"data-on-submit\") {\n            let metadata = event.data.data;\n            metadata[\"column_mappings\"] = event.data.column_mapping;\n            delete metadata[\"unique_token\"];\n            onSubmit?.(metadata);\n          }\n          else if(event.data.type && event.data.type == \"data-push-status\") {\n            if(event.data.data.import_status == \"success\") {\n              if(event.data && event.data.row_data) {\n                let primary_row_data = event.data.row_data;\n                let headers = event.data.headers;\n                let rows = [];\n                let dynamic_columns_indexes = event.data.dynamicColumnsIndexes;\n                let virtual_columns_indexes = event.data.virtualColumnsIndexes || [];\n\n                let dropdown_display_labels_mappings = event.data.dropdown_display_labels_mappings;\n                primary_row_data.forEach((row_data) => {\n                    let x = {};\n                    let dynamic_columns = {};\n                    let virtual_data = {};\n                    row_data.data?.forEach((col, i) => {\n                        if(col == undefined){ col = \"\" }\n                        if(!!dropdown_display_labels_mappings[i] && !!dropdown_display_labels_mappings[i][col]) {\n                            col = dropdown_display_labels_mappings[i][col];\n                        }\n                        if(dynamic_columns_indexes.includes(i)) {\n                          dynamic_columns[headers[i]] = col;\n                        }\n                        else if(virtual_columns_indexes.includes(i)) {\n                          virtual_data[headers[i]] = col;\n                        }\n                        else{\n                            x[headers[i]] = col;\n                        }\n                    });\n                    if(row_data.unmapped_data) {\n                      x[\"_unmapped_data\"] = row_data.unmapped_data;\n                    }\n                    if(dynamic_columns && Object.keys(dynamic_columns).length > 0) {\n                      x[\"_dynamic_data\"] = dynamic_columns;\n                    }\n                    if(virtual_data && Object.keys(virtual_data).length > 0) {\n                      x[\"_virtual_data\"] = virtual_data;\n                    }\n                    rows.push(x);\n                });\n                let metadata = event.data.data;\n                metadata[\"rows\"] = rows;\n                metadata[\"column_mappings\"] = event.data.column_mapping;\n                metadata[\"raw_columns\"] = event.data.raw_columns;\n                metadata[\"ignored_columns\"] = event.data.ignored_column_row;\n                delete metadata[\"unique_token\"];\n                onImport(true, metadata);\n              }else{\n                let metadata = event.data.data;\n                delete metadata[\"unique_token\"];\n                onImport(true, metadata);\n              }\n            }else {\n              onImport(false, event.data.data);\n            }\n          } else if(event.data.type && event.data.type == \"csvbox-modal-hidden\") {\n            if (this.holder && this.holder.current) {\n              this.holder.current.style.display = 'none';\n            };\n            this.isModalShown = false;\n            onClose?.();\n          } else if(event.data.type && event.data.type == \"csvbox-upload-successful\") {\n            this.onImport?.(true);\n          } else if(event.data.type && event.data.type == \"csvbox-upload-failed\") {\n            this.onImport?.(false);\n          }\n        }\n      }\n    }, false);\n\n    let self = this;\n\n    let iframe = document.createElement(\"iframe\");\n    this.iframe = iframe;\n    iframe.setAttribute(\"src\", iframeUrl);\n    iframe.frameBorder = 0;\n    iframe.classList.add('csvbox-iframe');\n\n    iframe.style.height = \"100%\";\n    iframe.style.width = \"100%\";\n    iframe.style.position = \"absolute\";\n    iframe.style.top = \"0px\";\n    iframe.style.left = \"0px\";\n\n    window.addEventListener(\"message\", this.onMessageEvent, false);\n\n    iframe.onload = function () {\n      self.enableInitator();\n      iframe.contentWindow.postMessage({\n        \"customer\" : user ? user : null,\n        \"columns\" : dynamicColumns ? dynamicColumns : null,\n        \"options\" : options ? options : null,\n        \"unique_token\": self.uuid\n      }, \"*\");\n      onReady?.();\n      if(self.shouldOpenModalOnReady) {\n        self.openModal();\n        self.shouldOpenModalOnReady = false;\n      }\n    }\n    this.holder.current.appendChild(iframe);\n  }\n\n  openModal() {\n\n    const { lazy } = this.props;\n\n    if(lazy) {\n      if(!this.iframe) {\n          this.shouldOpenModalOnReady = true;\n          this.initImporter();\n          return;\n      }\n    }\n\n    if(!this.isModalShown) {\n      if(!this.state.isLoading) {\n        this.isModalShown = true;\n        this.iframe.contentWindow.postMessage('openModal', '*');\n        this.holder.current.style.display = 'block';\n      } else {\n        this.shouldOpenModalOnReady = true;\n      }\n    }\n\n  }\n\n  generateUuid() {\n    return Math.random().toString(36).substring(2, 15) + Math.random().toString(36).substring(2, 15);\n  }\n\n  enableInitator() {\n    this.setState({\n      isLoading: false\n    })\n  }\n\n  render() {\n\n    const holderStyle = {\n      display: \"none\",\n      zIndex: 2147483647,\n      position: \"fixed\",\n      top: 0,\n      bottom: 0,\n      left: 0,\n      right: 0\n    };\n\n    if(this.props.render) {\n      return (\n        <div>\n          {this.props.render(this.openModal, this.state.isLoading)}\n          <div ref={this.holder} style={holderStyle}></div>\n        </div>\n      )\n    }else{\n      return (\n        <div>\n          <button disabled={this.state.isLoading} onClick={this.openModal} data-csvbox-initator data-csvbox-token={this.uuid}>{this.props.children}</button>\n          <div ref={this.holder} style={holderStyle}></div>\n        </div>\n      )\n    }\n\n\n  }\n}\n\nexport default CSVBoxButton;\n"],"names":["CSVBoxButton","props","holder","React","createRef","openModal","bind","isModalShown","shouldOpenModalOnReady","uuid","generateUuid","state","isLoading","iframe","componentDidMount","lazy","initImporter","enableInitator","loadStarted","user","dynamicColumns","options","onReady","onImport","onSubmit","onClose","licenseKey","dataLocation","customDomain","language","environment","theme","domain","iframeUrl","version","env","JSON","stringify","replace","match","window","addEventListener","event","data","current","style","display","unique_token","type","metadata","column_mapping","import_status","row_data","primary_row_data","headers","rows","dynamic_columns_indexes","dynamicColumnsIndexes","virtual_columns_indexes","virtualColumnsIndexes","dropdown_display_labels_mappings","forEach","x","dynamic_columns","virtual_data","col","i","undefined","includes","unmapped_data","Object","keys","length","push","raw_columns","ignored_column_row","self","document","createElement","setAttribute","frameBorder","classList","add","height","width","position","top","left","onMessageEvent","onload","contentWindow","postMessage","appendChild","Math","random","toString","substring","setState","render","holderStyle","zIndex","bottom","right","children","Component"],"mappings":"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"}